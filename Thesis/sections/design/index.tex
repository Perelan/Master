
\chapter{Analysis and High-Level Design}

It is the goal of this thesis to enable detection of sleep-related disorders with the aid of an Android device and low-cost sensors, and to further analyze and evaluate sleep- and breath-related patterns. We developed an application, called \textit{Nidra}, which attempts to collect, analyze, and share data collected from external sensors, all on a mobile device. Also, Nidra acts as a platform for modules to enrich the data, thus extending the functionality of the application.

The motivation behind this application is to provide an interface for patients to potentially run a self-diagnostic from home, and to aid researchers and doctors with analysis of sleep- and breathing-related illnesses (e.g., Obstructive Sleep Apnea). An overview of the Nidra application pipeline is found in Figure \ref{fig:parts}, beginning with data acquired from a sensor, and ending with the data in the Nidra application. As for now, Nidra consists of three main functionalities, each related to the requirements defined in the problem statement: 

\begin{enumerate}
    \item The application must provide an interface for the patient to (i) record physiological signals (e.g., breathing data); (ii) present the results; and (iii) share the results.
    \item The application must ensure that upon sensor disconnections, the connectivity is reinstated to minimize the data loss and its effects on the data analysis.
    \item The application must provide an interface for the developers to create modules that integrate with the application.
\end{enumerate}

This chapter will give a detailed look at the design of Nidra, including the tasks which constitute the structure of the application, the separate concerns in relation to the tasks, and the structure of the data in the application.

\section{Requirement Analysis}

\input{sections/design/reqanalysis}

\section{High-Level Design}

\subsection{Task Analysis}
Task analysis is a methodology to facilitate the design of complex systems. Hierarchical task analysis (HTA) is an underlying technique that analyzes and decomposes complex tasks such as planning, diagnosis, and decision making into specific subtasks \cite{ta}. In Figure \ref{fig:hta_overview}, an illustration of the tasks of the application is presented. This section introduces these tasks, which are an integral part of the development of the application.

\begin{figure}
    \centering
    \includegraphics[scale=0.23]{images/TA.png}
    \caption{The individual tasks that outline the application: (1) recording, (2) sharing, (3) modules, (4) analytics, (5) storage, and (6) presentation.}
    \label{fig:hta_overview}
\end{figure}

\input{sections/design/systemtasks}

\section{Seperation of Concerns}\label{design_soc}
Separation of concern is a paradigm that classifies an application into concerns at a conceptual and implementational level. It is beneficial for reducing complexity, improving understandability, and increasing reusability \cite{soc}. The concerns in this thesis are the individual tasks defined in the task analysis. Each concern is conceptualized with a graph of \textit{components}, the functionality of each component when combined constitutes a {structure}, that is derived based on research and development. This section proposes a solution for the structure of each concern, by analyzing and decomposing the tasks defined in task analysis into components.

\input{sections/design/soc}

\section{Data Structure}

\input{sections/design/datastructure}